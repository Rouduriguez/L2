#!/bin/bash
[ $# -eq 0 ] && exit 1 ## $1 : nom du fichier

echo `head -n 1 $1.sp1 ` > temp
nom="`cat temp | cut -d " " -f2`"
nombre="`cat temp | cut -d " " -f1`"
cpt=-1 ## car le touch l7 va compter pour un
touch $nom
for file in *
do 
	if test "`basename $file | cut -d. -f1`" = "`basename $1`"
	then
		if [ $file = *".sp1" ]
		then
			tail -n +2 $file >> $nom ## tail à partir de l2 pour suppr le header
		else
		cat $file >> $nom
		fi
		cpt=`expr $cpt + 1`	
	fi
done 
if [ $nombre -eq $cpt ]
then 
	echo "tous les fichiers sont rassemblés"
else
	echo "`expr $nombre - cpt` fichiers manquants"
fi
rm temp
